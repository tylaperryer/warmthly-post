<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="theme-color" content="#fff6f1" />
  <meta name="color-scheme" content="light" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Report - Warmthly</title>
  <link rel="preconnect" href="https://www.warmthly.org">
  <link rel="preconnect" href="https://post.warmthly.org">
  
  <!-- Favicon Set for All Devices -->
  <link rel="icon" type="image/png" sizes="32x32" href="/candle-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/candle-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/candle-apple.png">
  <style>
      /* --- ANTI-FLASH AND PERFORMANCE FIXES --- */
      :root { color-scheme: light; }
      html { background-color: #fff6f1; min-height: 100%; overflow-x: hidden; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none; }
      html::-webkit-scrollbar { display: none; }
      body { opacity: 0; visibility: hidden; transition: opacity 0.3s ease-in-out; }
      body.fonts-loaded { opacity: 1; visibility: visible; }
      /* --- END ANTI-FLASH FIXES --- */

      * { margin: 0; padding: 0; box-sizing: border-box; }
      @font-face { font-family: 'Cormorant Garamond'; font-style: normal; font-weight: 300 700; font-display: swap; src: url('/fonts/CormorantGaramond-VariableFont_wght.ttf') format('truetype'); }
      @font-face { font-family: 'Cormorant Garamond'; font-style: italic; font-weight: 300 700; font-display: swap; src: url('/fonts/CormorantGaramond-Italic-VariableFont_wght.ttf') format('truetype'); }
      @font-face { font-family: 'Inter'; font-style: normal; font-weight: 100 900; font-display: swap; src: url('/fonts/Inter-VariableFont_opsz,wght.ttf') format('truetype'); }
      @font-face { font-family: 'Inter'; font-style: italic; font-weight: 100 900; font-display: swap; src: url('/fonts/Inter-Italic-VariableFont_opsz,wght.ttf') format('truetype'); }
      
      body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #2c2c2c; background: #fff6f1; min-height: 100vh; position: relative; overflow-x: hidden; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none; }
      body::-webkit-scrollbar { display: none; }
      
      body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: radial-gradient(circle at 20% 30%, rgba(255,140,66,0.15) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255,182,193,0.12) 0%, transparent 50%), radial-gradient(circle at 40% 70%, rgba(173,216,230,0.1) 0%, transparent 50%), radial-gradient(circle at 90% 80%, rgba(144,238,144,0.08) 0%, transparent 50%), linear-gradient(135deg, #fff6f1 0%, #ffeee6 100%); z-index: -1; pointer-events: none; }
      
      ::selection { background: #FF8C42; color: #FFFFFF; }
      
      .container { max-width: 800px; margin: 0 auto; padding: 120px 20px 40px; text-align: center; color: #2c2c2c; position: relative; z-index: 1; }
      
      .top-left-heading { position: fixed; top: 20px; left: 20px; font-family: 'Cormorant Garamond', Georgia, serif; font-weight: 700; font-size: 2rem; color: #FF8C42; user-select: none; z-index: 1001; }
      .top-left-heading .warmthly-link { text-decoration: none; color: #FF8C42; }
      .top-left-heading .post-text { color: #ff4757; text-decoration: none; transition: color 0.3s ease; }
      .top-left-heading .post-text:hover { color: #ee3542; }
      
      .stoplight-container { position: fixed; top: 20px; right: 20px; z-index: 1002; }
      .stoplight { --tint-color: rgba(255,255,255,0.15); --blur-radius: 12px; --border-color: rgba(255,255,255,0.25); --highlight-color: rgba(255,255,255,0.4); --shadow-color: rgba(0,0,0,0.08); display: flex; flex-direction: column; gap: 3px; cursor: pointer; padding: 8px; position: relative; background: var(--tint-color); backdrop-filter: blur(var(--blur-radius)) saturate(1.2); -webkit-backdrop-filter: blur(var(--blur-radius)) saturate(1.2); border: 1px solid var(--border-color); border-radius: 14px; box-shadow: 0 6px 12px var(--shadow-color), inset 0 1px 1px var(--highlight-color), inset 0 -1px 1px rgba(0,0,0,0.05); transition: all 0.4s cubic-bezier(0.25,0.8,0.25,1); overflow: hidden; }
      .stoplight::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: inherit; background: linear-gradient(135deg, rgba(255,255,255,0.25), rgba(255,255,255,0.1) 50%, rgba(255,255,255,0) 100%); pointer-events: none; z-index: 1; opacity: 0.7; transition: opacity 0.4s cubic-bezier(0.25,0.8,0.25,1); }
      .stoplight:hover { background: rgba(255,255,255,0.25); box-shadow: 0 8px 16px rgba(0,0,0,0.12), inset 0 1px 1px rgba(255,255,255,0.5), inset 0 -1px 1px rgba(0,0,0,0.1); }
      .stoplight:hover::before { opacity: 1; }
      .stoplight-dot { width: 8px; height: 8px; border-radius: 50%; position: relative; transition: opacity 0.4s cubic-bezier(0.25,0.8,0.25,1); z-index: 2; opacity: 0.3; }
      .stoplight-dot.red { background: #ff4757; }
      .stoplight-dot.yellow { background: #FF8C42; }
      .stoplight-dot.green { background: #2ed573; }
      .stoplight-container:hover .stoplight-dot.red { animation: stoplight-cycle-red 10s cubic-bezier(0.25,0.8,0.25,1) infinite; }
      .stoplight-container:hover .stoplight-dot.green { animation: stoplight-cycle-green 10s cubic-bezier(0.25,0.8,0.25,1) infinite; }
      .stoplight-container:hover .stoplight-dot.yellow { animation: stoplight-cycle-yellow 10s cubic-bezier(0.25,0.8,0.25,1) infinite; }
      @keyframes stoplight-cycle-red { 0%, 33.33% { opacity: 1; } 33.34%, 100% { opacity: 0.3; } }
      @keyframes stoplight-cycle-green { 0%, 33.33% { opacity: 0.3; } 33.34%, 66.66% { opacity: 1; } 66.67%, 100% { opacity: 0.3; } }
      @keyframes stoplight-cycle-yellow { 0%, 66.66% { opacity: 0.3; } 66.67%, 100% { opacity: 1; } }
      .dropdown-menu { --tint-color: rgba(255,255,255,0.15); --blur-radius: 12px; --border-color: rgba(255,255,255,0.25); --highlight-color: rgba(255,255,255,0.4); --shadow-color: rgba(0,0,0,0.08); --text-color: #1c2526; position: absolute; top: 100%; right: 0; background: var(--tint-color); backdrop-filter: blur(var(--blur-radius)) saturate(1.2); -webkit-backdrop-filter: blur(var(--blur-radius)) saturate(1.2); border-radius: 18px; padding: 8px; margin-top: 12px; min-width: 200px; box-shadow: 0 8px 32px var(--shadow-color), inset 0 1px 1px var(--highlight-color), inset 0 -1px 1px rgba(0,0,0,0.05); border: 1px solid var(--border-color); opacity: 0; visibility: hidden; transform: translateY(-12px) scale(0.94); transition: all 0.4s cubic-bezier(0.4,0,0.2,1); overflow: hidden; }
      .dropdown-menu::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: inherit; background: linear-gradient(135deg, rgba(255,255,255,0.25), rgba(255,255,255,0.1) 50%, rgba(255,255,255,0) 100%); pointer-events: none; z-index: 1; opacity: 0.7; }
      .dropdown-menu.active { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
      .dropdown-item { display: block; padding: 12px 16px; margin: 2px 0; color: var(--text-color); text-decoration: none; font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; font-weight: 500; font-size: 0.95rem; transition: all 0.3s cubic-bezier(0.25,0.8,0.25,1); border-radius: 10px; position: relative; z-index: 2; }
      .dropdown-item:hover { color: #FF8C42; }
      .dropdown-item:first-child { margin-top: 0; }
      .dropdown-item:last-child { margin-bottom: 0; }
      
      .page-title { font-family: 'Inter', sans-serif; font-size: 1.8rem; color: #ff4757; margin-bottom: 1rem; font-weight: 600; text-align: center; letter-spacing: 0.02em; }
      .main-text { font-family: 'Inter', sans-serif; font-size: 1.1rem; margin-bottom: 3rem; opacity: 0.85; color: #2c2c2c; line-height: 1.7; text-align: left; }
      
      .section { background: linear-gradient(135deg, rgba(255,255,255,0.4), rgba(255,255,255,0.1)); padding: 2.5rem; border-radius: 20px; border: 1px solid rgba(255,71,87,0.15); margin: 3rem 0; text-align: left; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(0,0,0,0.06); }
      .section-title { font-family: 'Inter', sans-serif; font-size: 1.6rem; color: #ff4757; margin-bottom: 1rem; font-weight: 600; text-align: center; }
      .section p { opacity: 0.85; line-height: 1.8; margin-bottom: 1rem; }
      .section strong { font-weight: 600; color: #2c2c2c; }
      
      .report-form { margin-top: 2rem; }
      .form-group { margin-bottom: 1.5rem; }
      .form-label { display: block; font-family: 'Inter', sans-serif; font-weight: 600; color: #2c2c2c; margin-bottom: 0.5rem; font-size: 0.95rem; }
      .form-input, .form-textarea { width: 100%; padding: 0.9rem; font-size: 1rem; border: 2px solid rgba(255,71,87,0.2); border-radius: 12px; transition: all 0.3s ease; font-family: 'Inter', sans-serif; background: rgba(255,255,255,0.7); }
      .form-input:focus, .form-textarea:focus { outline: none; border-color: #ff4757; background: rgba(255,255,255,0.9); box-shadow: 0 0 0 3px rgba(255,71,87,0.1); }
      .form-textarea { min-height: 150px; resize: vertical; }
      .submit-button { background: #ff4757; color: white; padding: 1rem 2.5rem; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-family: 'Inter', sans-serif; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3); }
      .submit-button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 71, 87, 0.4); background: #ee3542; }
      .submit-button:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
      
      .success-message { background: rgba(46,213,115,0.1); border: 1px solid rgba(46,213,115,0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #2ed573; font-family: 'Inter', sans-serif; font-size: 0.9rem; display: none; }
      .error-message { background: rgba(255,71,87,0.1); border: 1px solid rgba(255,71,87,0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #ff4757; font-family: 'Inter', sans-serif; font-size: 0.9rem; display: none; }
      
      .info-box { background: rgba(255,71,87,0.08); border-left: 4px solid #ff4757; padding: 1.5rem; border-radius: 8px; margin: 2rem 0; }
      .info-box p { margin: 0; opacity: 0.9; }
      
      /* Skip navigation link for accessibility - visually hidden until focused */
      .skip-link { border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px; }
      .skip-link:focus { clip: auto; height: auto; margin: 0; overflow: visible; position: absolute; top: 10px; left: 10px; width: auto; z-index: 10000; background: #ff4757; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px; }
      
      /* Accessibility: Respect reduced motion preference */
      @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
      }
      
      @media (max-width: 768px) {
            .container { padding-top: 80px; padding-left: 15px; padding-right: 15px; }
            .top-left-heading { font-size: 1.6rem; top: 15px; left: 15px; }
            .stoplight-container { top: 15px; right: 15px; }
            .page-title { font-size: 1.5rem; }
            .main-text { font-size: 1rem; }
            .section-title { font-size: 1.4rem; }
            .section { padding: 2rem 1.5rem; }
      }
  </style>
  
</head>
<body class="fonts-loading">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <div class="top-left-heading">
    <a href="https://www.warmthly.org" class="warmthly-link">Warmthly</a>
    <a href="https://post.warmthly.org" class="post-text">Post</a>
  </div>
  
  <div class="stoplight-container">
    <div class="stoplight" id="stoplight">
      <div class="stoplight-dot red"></div>
      <div class="stoplight-dot yellow"></div>
      <div class="stoplight-dot green"></div>
    </div>
    <div class="dropdown-menu" id="dropdown-menu">
      <a href="https://www.warmthly.org" class="dropdown-item">Home</a>
      <a href="https://mint.warmthly.org" class="dropdown-item">Mint</a>
      <a href="https://post.warmthly.org" class="dropdown-item">Post</a>
    </div>
  </div>

  <div class="container" id="main-content" role="main">
    <h1 class="page-title">Report an Issue</h1>
    <p class="main-text">
      If you have concerns, questions, or need to report something related to Warmthly, please use the form below. We take all reports seriously and will review them promptly.
    </p>

    <div class="section">
        <h2 class="section-title">Your Voice Matters</h2>
        <p>
            Transparency and accountability are core to our mission. If you've witnessed something that doesn't align with our values—Transparency, Honesty, Humility, and Empathy—we want to know. Your report will be reviewed by our team and addressed appropriately.
        </p>
        
        <div class="info-box">
          <p><strong>Note:</strong> All reports are reviewed confidentially. We take every concern seriously and will investigate all valid reports thoroughly.</p>
        </div>
        
        <form class="report-form" id="reportForm">
          <div class="form-group">
            <label for="reportName" class="form-label">Your Name</label>
            <input type="text" id="reportName" class="form-input" placeholder="Enter your name" required />
          </div>
          
          <div class="form-group">
            <label for="reportEmail" class="form-label">Your Email</label>
            <input type="email" id="reportEmail" class="form-input" placeholder="your.email@example.com" required />
          </div>
          
          <div class="form-group">
            <label for="reportType" class="form-label">Report Type</label>
            <select id="reportType" class="form-input" required>
              <option value="">Select a type...</option>
              <option value="media">Media Inquiry</option>
              <option value="concern">Concern or Complaint</option>
              <option value="admin">Administrative Issue</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="reportMessage" class="form-label">Message</label>
            <textarea id="reportMessage" class="form-textarea" placeholder="Please describe your issue or inquiry in detail..." required></textarea>
          </div>
          
          <div class="success-message" id="successMessage" role="alert" aria-live="polite">Thank you for your report. We've received your message and will review it promptly.</div>
          <div class="error-message" id="errorMessage" role="alert" aria-live="polite"></div>
          
          <button type="submit" class="submit-button" id="submitButton">Submit Report</button>
        </form>
    </div>
  </div>
  
  <script>
    // --- NATIVE FONT LOADING ---
    if (document.fonts && document.fonts.ready) {
      document.fonts.ready.then(() => {
        document.body.classList.remove('fonts-loading');
        document.body.classList.add('fonts-loaded');
      });
      
      // Fallback timeout
      setTimeout(() => {
        document.body.classList.remove('fonts-loading');
        document.body.classList.add('fonts-loaded');
      }, 3000);
    } else {
      // Fallback for older browsers
      document.body.classList.remove('fonts-loading');
      document.body.classList.add('fonts-loaded');
    }
    // --- END FONT LOADING ---

    // Form submission handler
    const reportForm = document.getElementById('reportForm');
    const submitButton = document.getElementById('submitButton');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    
    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.display = 'block';
      successMessage.style.display = 'none';
    }
    
    function showSuccess() {
      successMessage.style.display = 'block';
      errorMessage.style.display = 'none';
    }
    
    function hideMessages() {
      successMessage.style.display = 'none';
      errorMessage.style.display = 'none';
    }
    
    reportForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      hideMessages();
      
      const formData = {
        name: document.getElementById('reportName').value.trim(),
        email: document.getElementById('reportEmail').value.trim(),
        type: document.getElementById('reportType').value,
        message: document.getElementById('reportMessage').value.trim()
      };
      
      // Validate form
      if (!formData.name || !formData.email || !formData.type || !formData.message) {
        showError('Please fill in all required fields.');
        return;
      }
      
      if (!formData.email.includes('@')) {
        showError('Please enter a valid email address.');
        return;
      }
      
      // Disable submit button
      submitButton.disabled = true;
      submitButton.textContent = 'Submitting...';
      
      try {
        const response = await fetch('/api/reports', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        });
        
        const result = await response.json();
        
        if (!response.ok) {
          throw new Error(result.error?.message || 'Failed to submit report');
        }
        
        showSuccess();
        reportForm.reset();
        
        // Reset button after 3 seconds
        setTimeout(() => {
          submitButton.disabled = false;
          submitButton.textContent = 'Submit Report';
          hideMessages();
        }, 3000);
        
      } catch (error) {
        console.error('Error submitting report:', error);
        showError('Failed to submit report. Please try again or contact us directly.');
        submitButton.disabled = false;
        submitButton.textContent = 'Submit Report';
      }
    });

    // Stoplight menu functionality
    const stoplight = document.getElementById('stoplight');
    const dropdownMenu = document.getElementById('dropdown-menu');
    let isMenuOpen = false;
    
    function toggleMenu() {
      isMenuOpen = !isMenuOpen;
      stoplight.classList.toggle('active', isMenuOpen);
      dropdownMenu.classList.toggle('active', isMenuOpen);
      stoplight.setAttribute('aria-expanded', isMenuOpen ? 'true' : 'false');
    }
    
    // Add keyboard support for stoplight
    stoplight.setAttribute('role', 'button');
    stoplight.setAttribute('tabindex', '0');
    stoplight.setAttribute('aria-label', 'Open navigation menu');
    stoplight.setAttribute('aria-expanded', 'false');
    stoplight.setAttribute('aria-haspopup', 'true');
    
    stoplight.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleMenu();
    });
    
    stoplight.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ' || e.key === 'ArrowDown') {
        e.preventDefault();
        toggleMenu();
      }
    });
    
    document.addEventListener('click', (e) => {
      if (!stoplight.contains(e.target) && !dropdownMenu.contains(e.target) && isMenuOpen) {
        toggleMenu();
      }
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && isMenuOpen) {
        toggleMenu();
      }
    });
    
    dropdownMenu.addEventListener('click', (e) => {
      e.stopPropagation();
    });
  </script>
</body>
</html>

